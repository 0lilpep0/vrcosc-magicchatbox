<Window
    x:Class="vrcosc_magicchatbox.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:local="clr-namespace:vrcosc_magicchatbox.Classes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:vrcosc_magicchatbox.ViewModels"
    Title="MagicChatbox by BoiHanny"
    Width="900"
    Height="752"
    VerticalAlignment="Bottom"
    AllowsTransparency="True"
    Background="Transparent"
    IsEnabled="{Binding AppIsEnabled, UpdateSourceTrigger=PropertyChanged}"
    Opacity="{Binding AppOpacity, UpdateSourceTrigger=PropertyChanged}"
    ResizeMode="NoResize"
    Topmost="{Binding Topmost, UpdateSourceTrigger=PropertyChanged}"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">
    <i:Interaction.Behaviors>
        <local:CustomKeyBinding Key="V" Command="{Binding ToggleVoiceCommand}" />
    </i:Interaction.Behaviors>
    <Window.Resources>
        <ResourceDictionary>

            <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter" />
            <local:InverseBoolToHiddenConverter x:Key="InverseBoolToHiddenConverter" />
            <local:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
            <Style x:Key="FocusVisual">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Rectangle
                                Margin="2"
                                SnapsToDevicePixels="true"
                                Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                StrokeDashArray="1 2"
                                StrokeThickness="1" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <SolidColorBrush x:Key="Button.Static.Background" Color="#FFDDDDDD" />
            <SolidColorBrush x:Key="Button.Static.Border" Color="#FF707070" />
            <SolidColorBrush x:Key="Button.MouseOver.Background" Color="#FFBEE6FD" />
            <SolidColorBrush x:Key="Button.MouseOver.Border" Color="#FF3C7FB1" />
            <SolidColorBrush x:Key="Button.Pressed.Background" Color="#FFC4E5F6" />
            <SolidColorBrush x:Key="Button.Pressed.Border" Color="#FF2C628B" />
            <SolidColorBrush x:Key="Button.Disabled.Background" Color="#FFF4F4F4" />
            <SolidColorBrush x:Key="Button.Disabled.Border" Color="#FFADB2B5" />
            <SolidColorBrush x:Key="Button.Disabled.Foreground" Color="#FF838383" />
            <Style x:Key="Activatebutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5,0,0,5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="Favbutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0,5,5,0"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="Deletebutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5,0,0,5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="1" Visibility="{Binding IntgrIntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
            <Border
                Height="87"
                Margin="10,0,10,0"
                VerticalAlignment="Top"
                BorderBrush="#FF240E55"
                BorderThickness="1"
                CornerRadius="0,0,5,5"
                Visibility="{Binding IntgrIntelliWing, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                <Border.Effect>
                    <DropShadowEffect
                        BlurRadius="8"
                        Direction="-63"
                        RenderingBias="Quality"
                        ShadowDepth="0"
                        Color="#FF1B1BAF" />
                </Border.Effect>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0.1,1" EndPoint="0.5,1">
                        <GradientStop Color="#FF251454" />
                        <GradientStop Offset="1" Color="#FF1B0C3A" />
                    </LinearGradientBrush>
                </Border.Background>
                <Grid Margin="0,0,0,0">
                    <ItemsControl ItemsSource="{Binding OpenAIAPIBuiltInActions}" Tag="Chat">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel MaxWidth="900" Orientation="Horizontal" />
                                <!--  Adjust MaxWidth based on the width of your buttons and the desired number of items per row  -->
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button
                                    Width="150"
                                    Margin="3"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Command="{Binding DataContext.YourCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                    CommandParameter="{Binding}"
                                    Content="{Binding FriendlyName}"
                                    FontSize="10"
                                    Style="{StaticResource Status_Button_style_Small}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>
        </Grid>



        <Border
            Grid.Row="0"
            Height="630"
            Margin="10,10,10,0"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderBrush="#FF240E55"
            BorderThickness="1">
            <Border.Effect>
                <DropShadowEffect
                    BlurRadius="15"
                    Direction="-63"
                    RenderingBias="Quality"
                    ShadowDepth="0"
                    Color="DarkBlue" />
            </Border.Effect>
            <Grid Background="#FF3B3054">
                <Grid.RowDefinitions>
                    <RowDefinition Height="55" />
                    <RowDefinition />
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="3*" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <Grid Grid.ColumnSpan="2" Background="#FF2D1267">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="143" />
                        <ColumnDefinition Width="123" />
                        <ColumnDefinition Width="123" />
                        <ColumnDefinition Width="122" />
                        <ColumnDefinition Width="130" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Border>
                        <Grid x:Name="Drag_area" MouseDown="Drag_area_MouseDown">
                            <TextBlock
                                Grid.Column="0"
                                Padding="0,12,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="White"
                                Text="MagicChatbox">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Direction="315"
                                        Opacity="1"
                                        ShadowDepth="0"
                                        Color="Black" />
                                </TextBlock.Effect>
                            </TextBlock>
                            <TextBlock
                                Grid.Column="0"
                                Padding="20,12,0,0"
                                HorizontalAlignment="left"
                                VerticalAlignment="top"
                                FontFamily="Albert Sans Thin"
                                FontSize="10"
                                Foreground="MediumPurple"
                                Text="VRC OSC">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Direction="315"
                                        Opacity="1"
                                        ShadowDepth="0"
                                        Color="Black" />
                                </TextBlock.Effect>
                            </TextBlock>
                        </Grid>
                    </Border>

                    <Grid Grid.Column="1" Margin="3,0,3,0">
                        <Button
                            Name="MenuButton_0"
                            Margin="0,0,0,0"
                            Background="#FF240E55"
                            BorderThickness="0"
                            Click="MenuButton_0_Click"
                            Content="Integrations"
                            Cursor="Hand"
                            FontFamily="Comfortaa Light"
                            FontSize="18"
                            FontWeight="Normal"
                            Foreground="White"
                            Style="{DynamicResource MenuItemStyle}" />
                        <Border
                            Height="4"
                            VerticalAlignment="Top"
                            Background="#FFAEA7ED"
                            IsHitTestVisible="False"
                            Visibility="{Binding MenuItem_0_Visibility}" />
                    </Grid>
                    <Grid Grid.Column="2" Margin="3,0,3,0">
                        <Button
                            Name="MenuButton_1"
                            Margin="0,0,0,0"
                            Background="#FF240E55"
                            BorderThickness="0"
                            Click="MenuButton_1_Click"
                            Content="Status"
                            Cursor="Hand"
                            FontFamily="Comfortaa Light"
                            FontSize="18"
                            FontWeight="Normal"
                            Foreground="White"
                            Style="{DynamicResource MenuItemStyle}" />
                        <Border
                            Height="4"
                            VerticalAlignment="Top"
                            Background="#FFAEA7ED"
                            IsHitTestVisible="False"
                            Visibility="{Binding MenuItem_1_Visibility}" />
                    </Grid>
                    <Grid Grid.Column="3" Margin="3,0,3,0">
                        <Button
                            Name="MenuButton_2"
                            Margin="0,0,0,0"
                            Background="#FF240E55"
                            BorderThickness="0"
                            Click="MenuButton_2_Click"
                            Content="Chatting"
                            Cursor="Hand"
                            FontFamily="Comfortaa Light"
                            FontSize="18"
                            FontWeight="Normal"
                            Foreground="White"
                            Style="{DynamicResource MenuItemStyle}" />
                        <Border
                            Height="4"
                            VerticalAlignment="Top"
                            Background="#FFAEA7ED"
                            IsHitTestVisible="False"
                            Visibility="{Binding MenuItem_2_Visibility}" />
                    </Grid>
                    <Grid Grid.Column="4" Margin="3,0,3,0">
                        <Button
                            Name="MenuButton_3"
                            Margin="0,0,0,0"
                            Background="#FF240E55"
                            BorderThickness="0"
                            Click="MenuButton_3_Click"
                            Content="Options"
                            Cursor="Hand"
                            FontFamily="Comfortaa Light"
                            FontSize="18"
                            FontWeight="Normal"
                            Foreground="White"
                            Style="{DynamicResource MenuItemStyle}" />
                        <Border
                            Height="4"
                            VerticalAlignment="Top"
                            Background="#FFAEA7ED"
                            IsHitTestVisible="False"
                            Visibility="{Binding MenuItem_3_Visibility}" />
                    </Grid>
                    <Grid Grid.Column="5">
                        <StackPanel
                            Margin="3,0,0,0"
                            Background="#FF3B2075"
                            Orientation="Vertical">
                            <TextBlock
                                Margin="0,5,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FFB3B0B9"
                                Text="Sent to VRChat" />
                            <CheckBox
                                Name="MasterSwitch"
                                Width="62"
                                Margin="0,5,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="MasterSwitch_Click"
                                IsChecked="{Binding MasterSwitch, Mode=TwoWay}"
                                Opacity="0.75"
                                Style="{DynamicResource Switch}" />
                        </StackPanel>
                    </Grid>
                    <Grid Grid.Column="6" HorizontalAlignment="Right">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="45" />
                            <ColumnDefinition Width="45" />
                        </Grid.ColumnDefinitions>
                        <Button
                            Name="Button_close"
                            Grid.Column="1"
                            Width="45"
                            Height="22"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Top"
                            Background="#004D0606"
                            BorderThickness="0"
                            Click="Button_close_Click"
                            Cursor="Hand"
                            Style="{DynamicResource CloseButtonStyle}">
                            <Image Margin="2" Source="img/icons/Close_ico.png" />
                        </Button>
                        <Button
                            Name="Button_minimize"
                            Width="45"
                            Height="22"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Top"
                            Background="#00473C89"
                            BorderThickness="0"
                            Click="Button_minimize_Click"
                            Cursor="Hand"
                            Style="{DynamicResource SubtractButtonStyle}">
                            <Image Margin="2" Source="img/icons/subtract_ico.png" />
                        </Button>
                    </Grid>

                </Grid>
                <Grid
                    Grid.Row="1"
                    Background="#FF3B3054"
                    Visibility="{Binding MenuItem_1_Visibility}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="31" />
                        <RowDefinition Height="35" />
                        <RowDefinition Height="400" />
                        <RowDefinition Height="40" />
                        <RowDefinition Height="68" />
                    </Grid.RowDefinitions>

                    <Grid Background="#FF41375C">
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Grid.Column="0"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text="Here you can add ur personal message to the chatbox!" />
                        </StackPanel>
                    </Grid>
                    <ScrollViewer
                        Name="Statusitems"
                        Grid.Row="2"
                        Margin="10,0,0,0"
                        Visibility="Visible">
                        <ItemsControl
                            Width="auto"
                            Height="auto"
                            Margin="5"
                            ItemsSource="{Binding StatusList}">
                            <ItemsControl.Resources>
                                <Style x:Key="ActiveStatusText" TargetType="TextBlock">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                                            <Setter Property="Foreground" Value="#FF9DDAA8" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsActive}" Value="False">
                                            <Setter Property="Foreground" Value="LightGray" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ItemsControl.Resources>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Margin="5"
                                        Background="DarkSlateBlue"
                                        CornerRadius="5">
                                        <Border.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Direction="-23"
                                                RenderingBias="Quality"
                                                ShadowDepth="0"
                                                Color="DarkBlue" />
                                        </Border.Effect>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="35" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="35" />
                                                <ColumnDefinition Width="507" />
                                                <ColumnDefinition Width="35" />
                                                <ColumnDefinition Width="35" />
                                            </Grid.ColumnDefinitions>
                                            <Border
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Background="#3A1F73">
                                                <Image
                                                    Width="22"
                                                    Height="22"
                                                    Source="/Img/Icons/ActivatedStatus_ico.png"
                                                    Stretch="Uniform" />
                                            </Border>

                                            <Button
                                                x:Name="Deletebutton"
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Width="35"
                                                Height="35"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#483472"
                                                BorderThickness="0"
                                                Click="DeleteButton_Click"
                                                Cursor="Hand"
                                                Style="{DynamicResource Deletebutton}"
                                                Tag="{Binding}">
                                                <Grid>
                                                    <Image
                                                        Width="20"
                                                        Height="20"
                                                        Source="/Img/Icons/Delete_ico.png" />
                                                </Grid>
                                            </Button>


                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="1"
                                                Margin="8,0,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Comfortaa Light"
                                                FontSize="15"
                                                Style="{StaticResource ActiveStatusText}"
                                                Text="{Binding msg}" />
                                            <Button
                                                Name="Activatebutton"
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Width="35"
                                                Height="35"
                                                Margin="0,0,0,0"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#3A1F73"
                                                BorderThickness="0"
                                                Command="{Binding DataContext.ActivateStatusCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                CommandParameter="{Binding}"
                                                Cursor="Hand"
                                                Style="{DynamicResource Activatebutton}"
                                                Visibility="{Binding IsActive, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                <Image
                                                    Width="22"
                                                    Height="22"
                                                    Source="/Img/Icons/ActivateStatus_ico.png"
                                                    Stretch="Uniform" />
                                            </Button>

                                            <Button
                                                Name="Favbutton"
                                                Grid.Row="0"
                                                Grid.Column="3"
                                                Width="35"
                                                Height="35"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#3A1F73"
                                                BorderThickness="0"
                                                Click="Favbutton_Click"
                                                Cursor="Hand"
                                                Style="{DynamicResource Favbutton}">
                                                <Grid>
                                                    <Image Width="22" Height="22">
                                                        <Image.Style>
                                                            <Style>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsFavorite}" Value="True">
                                                                        <Setter Property="Image.Source" Value="/Img/Icons/Unfavorite_ico.png" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding IsFavorite}" Value="False">
                                                                        <Setter Property="Image.Source" Value="/Img/Icons/Favorite_ico.png" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Image.Style>
                                                    </Image>
                                                    <CheckBox
                                                        Width="35"
                                                        Height="35"
                                                        IsChecked="{Binding IsFavorite, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        Opacity="0" />
                                                </Grid>
                                            </Button>

                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    <Grid
                        Grid.Row="4"
                        Width="658"
                        Height="68"
                        HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="550" />
                            <ColumnDefinition Width="150" />
                        </Grid.ColumnDefinitions>
                        <Button
                            x:Name="AddFav"
                            Grid.ColumnSpan="2"
                            Width="94"
                            Margin="542,14,0,14"
                            HorizontalAlignment="Left"
                            Click="AddFav_Click"
                            Content="Create"
                            Style="{DynamicResource Status_Button_style}" />
                        <TextBox
                            x:Name="NewFavText"
                            Height="40"
                            Margin="15,0,0,0"
                            Padding="8,0,58,0"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Background="#FF7B7195"
                            BorderThickness="0"
                            FontSize="15"
                            Foreground="#FF240E54"
                            KeyDown="FavBox_KeyDown"
                            Text="{Binding NewStatusItemTxt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            TextAlignment="Left"
                            TextChanged="NewFavText_TextChanged">
                            <TextBox.Resources>
                                <Style TargetType="{x:Type Border}">
                                    <Setter Property="CornerRadius" Value="5" />
                                </Style>
                            </TextBox.Resources>
                            <TextBox.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </TextBox.Effect>
                        </TextBox>

                        <TextBlock
                            Grid.Column="0"
                            Margin="0,0,7,0"
                            Padding="0,3,0,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="12"
                            Foreground="{Binding StatusBoxColor}"
                            Text="{Binding StatusBoxCount}" />

                        <TextBlock
                            Height="40"
                            Margin="15,0,55,0"
                            Padding="8,9,5,0"
                            VerticalAlignment="Center"
                            FontSize="15"
                            Foreground="#FF3D2F5F"
                            IsHitTestVisible="False"
                            Text="Create here a new status"
                            TextAlignment="Left">
                            <TextBlock.Style>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Text, ElementName=NewFavText}" Value="">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName=NewFavText, Path=IsFocused}" Value="True">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>

                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>

                    </Grid>
                    <Grid
                        Grid.Row="3"
                        HorizontalAlignment="Stretch"
                        Background="#FF493F65">
                        <Grid.Effect>
                            <DropShadowEffect
                                BlurRadius="10"
                                Direction="90"
                                Opacity="0.5"
                                RenderingBias="Quality"
                                ShadowDepth="5"
                                Color="#FF7F759A" />
                        </Grid.Effect>
                        <TextBlock
                            Grid.Column="0"
                            Margin="16,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Foreground="#FF9983AD"
                            Text="{Binding StatusTopBarTxt}" />

                    </Grid>
                    <Grid Grid.Row="1" Background="#FF493F65">
                        <Grid.Effect>
                            <DropShadowEffect
                                BlurRadius="10"
                                Direction="-90"
                                Opacity="0.5"
                                RenderingBias="Quality"
                                ShadowDepth="5"
                                Color="#FF7F759A" />
                        </Grid.Effect>
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <Button
                                x:Name="SortUsed"
                                Width="100"
                                Height="25"
                                Margin="5,0,5,0"
                                Click="SortUsed_Click"
                                Content="Recent used"
                                Style="{DynamicResource Status_Button_style}" />
                            <Button
                                x:Name="SortFav"
                                Width="100"
                                Height="25"
                                Margin="5,0,5,0"
                                Click="SortFav_Click"
                                Content="Favorites"
                                Style="{DynamicResource Status_Button_style}" />
                            <Button
                                x:Name="SortDate"
                                Width="100"
                                Height="25"
                                Margin="5,0,5,0"
                                Click="SortDate_Click"
                                Content="Create date"
                                Style="{DynamicResource Status_Button_style}" />
                        </StackPanel>
                    </Grid>
                </Grid>
                <Grid
                    Grid.Row="1"
                    Background="#FF3B3054"
                    Visibility="{Binding MenuItem_0_Visibility}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25" />
                        <RowDefinition Height="85" />
                        <RowDefinition Height="85" />
                        <RowDefinition Height="85" />
                        <RowDefinition Height="85" />
                        <RowDefinition Height="85" />
                    </Grid.RowDefinitions>

                    <Grid Background="#FF41375C" Visibility="{Binding Char_Limit}">
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Grid.Column="0"
                                Margin="0,3,0,0"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text="Some intergrations can't be showed because a limit on characters" />
                        </StackPanel>
                    </Grid>
                    <Grid Grid.Row="1" Opacity="{Binding Status_Opacity}">
                        <Border
                            Margin="6"
                            Background="DarkSlateBlue"
                            CornerRadius="5">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="440" />
                                    <ColumnDefinition Width="123" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="0,8,0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        Text="Personal status" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,0,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        Text="With this integration you can write an epic status that you want to show to everyone in game"
                                        TextWrapping="Wrap" />

                                </Grid>

                                <Image
                                    Grid.Column="0"
                                    Margin="15"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Source="/Img/Icons/PersonalMsg_ico.png" />
                                <CheckBox
                                    Name="Status_Switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrStatus, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />

                            </Grid>
                        </Border>

                    </Grid>
                    <Grid Grid.Row="2" Opacity="{Binding HeartRate_Opacity}">
                        <Border
                            Margin="6"
                            Background="DarkSlateBlue"
                            CornerRadius="5">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="440" />
                                    <ColumnDefinition Width="123" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Grid.Row="0"
                                            Margin="0,8,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="20"
                                            Foreground="White"
                                            Text="Heart rate" />
                                        <TextBlock
                                            Grid.Row="0"
                                            Margin="8,9,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            Foreground="#ABA4B8"
                                            Text="Last update:"
                                            Visibility="{Binding IntgrHeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Grid.Row="0"
                                            Margin="3,9,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="11"
                                            Foreground="#ABA4B8"
                                            Text="{Binding HeartRateLastUpdate, StringFormat='{}{0:T}'}"
                                            Visibility="{Binding IntgrHeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,0,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        Text="With this integration, you can display your heart rate in real-time. Currently compatible with Pulsoid"
                                        TextWrapping="Wrap" />

                                </Grid>

                                <Image
                                    Grid.Column="0"
                                    Margin="15"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Source="/Img/Icons/HeartRate_ico.png" />
                                <CheckBox
                                    Name="HR_Switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrHeartRate, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />

                            </Grid>
                        </Border>

                    </Grid>
                    <Grid Grid.Row="3" Opacity="{Binding Window_Opacity}">
                        <Border
                            Margin="6"
                            Background="DarkSlateBlue"
                            CornerRadius="5">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="440" />
                                    <ColumnDefinition Width="123" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="0,8,0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        Text="Window activity" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,0,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        Text="Shows if you are in VR or DESKTOP mode, in desktop it will show in which application you are focused."
                                        TextWrapping="Wrap" />

                                </Grid>

                                <Image
                                    Grid.Column="0"
                                    Margin="9"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Source="/Img/Icons/WindowActivity_ico.png" />
                                <CheckBox
                                    Name="WindowActivity_switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanWindowActivity, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />

                            </Grid>
                        </Border>

                    </Grid>
                    <Grid Grid.Row="4" Opacity="{Binding Time_Opacity}">
                        <Border
                            Margin="6"
                            Background="DarkSlateBlue"
                            CornerRadius="5">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="440" />
                                    <ColumnDefinition Width="123" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="0,8,0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        Text="Current time" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,0,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        Text="This intergration works in VR mode, it will show your local                                                 machine time."
                                        TextWrapping="Wrap" />

                                </Grid>

                                <Image
                                    Grid.Column="0"
                                    Margin="7"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Source="/Img/Icons/SystemTime_ico.png" />
                                <CheckBox
                                    Name="SystemTime_switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanWindowTime, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />

                            </Grid>
                        </Border>

                    </Grid>
                    <Grid Grid.Row="5" Opacity="{Binding Spotify_Opacity}">
                        <Border
                            Margin="6"
                            Background="DarkSlateBlue"
                            CornerRadius="5">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="440" />
                                    <ColumnDefinition Width="123" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="0,8,0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        Text="Spotify" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,0,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        Text="This intergration will show the playing song title and artist, It will also show                                                 if the song is paused."
                                        TextWrapping="Wrap" />

                                </Grid>

                                <Image
                                    Grid.Column="0"
                                    Margin="15"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Source="/Img/Icons/spotify_ico.png" />
                                <CheckBox
                                    Name="Spotify_switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanSpotify, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />

                            </Grid>
                        </Border>

                    </Grid>




                </Grid>
                <ScrollViewer
                    Grid.Row="1"
                    Background="#FF3B3054"
                    Visibility="{Binding MenuItem_3_Visibility}">

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_Status, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Status options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>


                            <Grid
                                x:Name="Settings_Status_Grid"
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_Status, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <CheckBox
                                    x:Name="StatusIconPrefix_checkbox"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding PrefixIconStatus, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Add 💬 as prefix for the personal status
                                </CheckBox>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="1" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_HeartRate, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Heart monitoring options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_HeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <TextBlock
                                        Padding="0,0,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="14"
                                        Foreground="#FFB9B5C1"
                                        Text="Pulsoid access token" />
                                    <TextBox
                                        x:Name="PulsoidAccessToken"
                                        Width="223"
                                        Height="26"
                                        Margin="0,3,0,0"
                                        Padding="5,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Background="#FF7B7195"
                                        BorderThickness="0"
                                        FontSize="15"
                                        Foreground="#FF240E54"
                                        Text="{Binding PulsoidAccessToken, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Grid.Column="0"
                                        Padding="0,10,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="14"
                                        Foreground="#FFB9B5C1"
                                        Text="Heart rate request interval" />
                                    <TextBox
                                        x:Name="heartRateScanInt"
                                        Width="40"
                                        Height="26"
                                        Margin="0,3,0,10"
                                        Padding="5,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Background="#FF7B7195"
                                        BorderThickness="0"
                                        FontSize="15"
                                        Foreground="#FF240E54"
                                        Text="{Binding HeartRateScanInterval, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Grid.Column="0"
                                        Padding="0,0,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="14"
                                        Foreground="#FFB9B5C1"
                                        Text="Heart rate adjustment " />
                                    <TextBox
                                        x:Name="HeartRateAdjustment"
                                        Width="40"
                                        Height="26"
                                        Margin="0,3,0,15"
                                        Padding="5,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Background="#FF7B7195"
                                        BorderThickness="0"
                                        FontSize="15"
                                        Foreground="#FF240E54"
                                        Text="{Binding HeartRateAdjustment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </StackPanel>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="2" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_Time, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Time options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_Time, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <CheckBox
                                        x:Name="OnlyShowTimeVR_checkbox"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding OnlyShowTimeVR, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Only show time in VR
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="PrefixTime_checkbox"
                                        Height="22"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding PrefixTime, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show 'My time:' in front of the time integration
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="Time24H_checkbox"
                                        Height="20"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding Time24H, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        24-Hour time format
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="AutoSetDaylight_checkbox"
                                        Height="20"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding AutoSetDaylight, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Auto daylight saving time
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="DaylightSavingTime_checkbox"
                                        Height="20"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding UseDaylightSavingTime, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click"
                                        Visibility="{Binding AutoSetDaylight, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        Daylight saving time
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="TimeShowTimeZone_checkbox"
                                        Height="20"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding TimeShowTimeZone, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Custom time zone
                                    </CheckBox>
                                    <StackPanel
                                        Width="auto"
                                        Height="22"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Left"
                                        Orientation="Horizontal"
                                        Visibility="{Binding TimeShowTimeZone, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">

                                        <ComboBox
                                            x:Name="TimeZoneComboBox"
                                            Width="183"
                                            Height="21"
                                            BorderBrush="#FF020000"
                                            DisplayMemberPath="Value"
                                            FontSize="11.5"
                                            ItemsSource="{Binding TimezoneFriendlyNames, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="0.4"
                                            SelectedValue="{Binding SelectedTimeZone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            SelectedValuePath="Key" />
                                        <TextBlock
                                            Margin="10,2,5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="16"
                                            Foreground="#FFB9B5C1"
                                            Text="Convert your local time to a standard time zone" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="3" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_Chatting, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Chatting options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_Chatting, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <TextBlock
                                        Grid.Column="0"
                                        Padding="0,0,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="14"
                                        Foreground="#FFB9B5C1"
                                        Text="Chat timeout" />
                                    <TextBox
                                        x:Name="ScanPauseCountDown"
                                        Width="40"
                                        Height="26"
                                        Margin="0,3,0,12"
                                        Padding="5,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Background="#FF7B7195"
                                        BorderThickness="0"
                                        FontSize="15"
                                        Foreground="#FF240E54"
                                        Text="{Binding ScanPauseTimeout, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <CheckBox
                                        x:Name="ChatIconPrefix_checkbox"
                                        Height="22"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding PrefixChat, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Add 💬 as prefix for chat messages
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="ChatFX_checkbox"
                                        Height="22"
                                        Margin="0,0,0,10"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ChatFX, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Play FX sound for VRChat users when sending message
                                    </CheckBox>
                                </StackPanel>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="4" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_TTS, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Text to speech options"
                                    TextOptions.TextRenderingMode="ClearType" />
                                <TextBlock
                                    x:Name="LearnMoreAboutTTSbtn"
                                    Width="auto"
                                    Margin="188,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Cursor="Hand"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#FF31B7B4"
                                    MouseUp="LearnMoreAboutTTSbtn_MouseUp"
                                    Text="Learn more"
                                    TextDecorations="Underline" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_TTS, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <CheckBox
                                        x:Name="TTSCutOff"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding TTSCutOff, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Stop current playing TTS on new chat
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="TTSAutoUnmute"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding AutoUnmuteTTS, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Autotoggle VRChat voice on TTS
                                    </CheckBox>

                                    <StackPanel
                                        Width="auto"
                                        Height="22"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Left"
                                        Orientation="Horizontal">
                                        <ComboBox
                                            x:Name="PlaybackOutputDeviceComboBox"
                                            Width="186"
                                            Height="25"
                                            Margin="0"
                                            DisplayMemberPath="FriendlyName"
                                            ItemsSource="{Binding PlaybackOutputDevices, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                            Opacity="0.4"
                                            SelectedItem="{Binding SelectedPlaybackOutputDevice, Mode=TwoWay}"
                                            SelectionChanged="PlaybackOutputDeviceComboBox_SelectionChanged" />
                                        <TextBlock
                                            Margin="10,0,5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="16"
                                            Foreground="#FFB9B5C1"
                                            Text="TTS Output" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid>

                        </Grid>
                        <Grid Grid.Row="5" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_Spotify, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Spotify options"
                                    TextOptions.TextRenderingMode="ClearType" />
                                <TextBlock
                                    x:Name="LearnMoreAboutSpotifybtn"
                                    Width="auto"
                                    Margin="143,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Cursor="Hand"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#FF31B7B4"
                                    MouseUp="LearnMoreAboutSpotifybtn_MouseUp"
                                    Text="Learn more"
                                    TextDecorations="Underline" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_Spotify, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <CheckBox
                                        x:Name="MusicIconPrefix_checkbox"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding PrefixIconMusic, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Change 'listening to:' prefix to 🎵
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="PauseIconPrefix_checkbox"
                                        Height="20"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding PauseIconMusic, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click"
                                        Visibility="{Binding PrefixIconMusic, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        Show ⏸ when  music is paused
                                    </CheckBox>
                                </StackPanel>
                            </Grid>

                        </Grid>
                        <Grid Grid.Row="6" Margin="0,5,0,0"
                            Cursor="No">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_IntelliChat, Mode=TwoWay}"
                                    IsEnabled="False"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="IntelliChat options"
                                    TextOptions.TextRenderingMode="ClearType" />
                                <TextBlock
                                    x:Name="LearnMoreAboutIntelliChatAI"
                                    Width="auto"
                                    Margin="165,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Cursor="Hand"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#FF31B7B4"
                                    MouseUp="LearnMoreAboutIntelliChatAI_MouseUp"
                                    Text="Learn more"
                                    TextDecorations="Underline" />
                                <TextBlock
                                    x:Name="IntelliChatAIapiPage"
                                    Width="auto"
                                    Margin="233,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Cursor="Hand"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#FF31B7B4"
                                    MouseUp="IntelliChatAIapiPage_MouseUp"
                                    Text="Generate API key"
                                    TextDecorations="Underline" />
                                <TextBlock
                                    x:Name="OpenAITerms"
                                    Width="auto"
                                    Margin="331,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Cursor="Hand"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#FF847E94"
                                    MouseUp="OpenAITerms_MouseUp"
                                    Text="OpenAI terms" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_IntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <CheckBox
                                        x:Name="IntelliChat_Enable"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding IntgrIntelliChat, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Enable IntelliChat
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="IntelliChatModeration"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        Content="Moderation on prompts to OpenAI"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding IntelliChatModeration, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Visibility="{Binding IntgrIntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    <StackPanel
                                        Width="auto"
                                        Height="22"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Left"
                                        Orientation="Horizontal"
                                        Visibility="{Binding IntgrIntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <ComboBox
                                            x:Name="IntelliChatAI_Model"
                                            Width="135"
                                            Height="21"
                                            BorderBrush="#FF020000"
                                            FontSize="11.5"
                                            ItemsSource="{Binding OpenAIAPIModels, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="0.4"
                                            SelectedItem="{Binding OpenAIAPISelectedModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            SelectionChanged="TikTokTTSVoices_combo_SelectionChanged" />
                                        <TextBlock
                                            Margin="10,0,5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Comfortaa Light"
                                            FontSize="16"
                                            Foreground="#FFB9B5C1"><Run Text="GPT Model (use GPT-3 for cheap and fast " /><Run Language="en-gb" Text="promts" /><Run Text=")" /></TextBlock>
                                    </StackPanel>
                                    <StackPanel
                                        Width="auto"
                                        Height="auto"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal"
                                        Visibility="{Binding IntgrIntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <StackPanel HorizontalAlignment="Left">
                                            <TextBlock
                                                Grid.Column="0"
                                                Padding="0,0,0,0"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Foreground="#FFB9B5C1"
                                                Text="OpenAI API key" />
                                            <TextBox
                                                x:Name="OpenAIAPIUrl"
                                                Width="223"
                                                Height="26"
                                                Margin="0,3,0,0"
                                                Padding="5,0,0,0"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding OpenAIAPIKey, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                        <Button
                                            x:Name="OpenAIAPITestConnection"
                                            Width="85"
                                            Height="26"
                                            Margin="10,15,5,0"
                                            VerticalAlignment="Bottom"
                                            Click="OpenAIAPITestConnection_ClickAsync"
                                            Content="Say 'Hi' to GPT"
                                            Style="{DynamicResource Status_Button_style}" />
                                        <TextBlock
                                            Grid.Column="0"
                                            Width="310"
                                            MaxWidth="200"
                                            Padding="0,0,0,5"
                                            VerticalAlignment="Bottom"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="12"
                                            Foreground="#FF008BFF"
                                            Text="{Binding OpenAIAPITestResponse, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid>


                        </Grid>
                        <Grid Grid.Row="7" Margin="0,5,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,0">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_AppOptions, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="App options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>
                            <Grid
                                Grid.Row="1"
                                Height="Auto"
                                Margin="10,10,0,0"
                                Visibility="{Binding Settings_AppOptions, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel>
                                    <StackPanel>
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Foreground="#FFB9B5C1"
                                            Text="Local IP address" />
                                        <TextBox
                                            x:Name="OSCIPBox"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,0"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding OSCIP, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Foreground="#FFB9B5C1"
                                            Text="Port (outgoing)" />
                                        <TextBox
                                            x:Name="OSCPortOutBox"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,15"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding OSCPortOut, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    </StackPanel>
                                    <CheckBox
                                        x:Name="WindowOnTop_checkbox"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding Topmost, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Always on top
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="ToggleVoiceWithV"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ToggleVoiceWithV, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Toggle VRChat voice with 'V'
                                    </CheckBox>
                                    <StackPanel Orientation="Horizontal">
                                        <Button
                                            x:Name="ResetFavorites"
                                            Width="85"
                                            Height="25"
                                            Margin="0,0,5,15"
                                            HorizontalAlignment="Left"
                                            Click="ResetFavorites_Click"
                                            Content="Reset Status"
                                            Style="{DynamicResource Status_Button_style}" />
                                        <Button
                                            x:Name="MakeDataDump"
                                            Width="99"
                                            Height="25"
                                            Margin="5,0,5,15"
                                            Click="MakeDataDump_Click"
                                            Content="Make data dump"
                                            Style="{DynamicResource Status_Button_style}" />
                                        <Button
                                            x:Name="OpenConfigFolder"
                                            Width="111"
                                            Height="25"
                                            Margin="5,0,5,15"
                                            Click="OpenConfigFolder_Click"
                                            Content="Open config folder"
                                            Style="{DynamicResource Status_Button_style}" />
                                        <Button
                                            x:Name="OpenLogFolder"
                                            Width="101"
                                            Height="25"
                                            Margin="5,0,5,15"
                                            Click="OpenLogFolder_Click"
                                            Content="Open log folder"
                                            Style="{DynamicResource Status_Button_style}" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid>


                        </Grid>
                        <Grid Grid.Row="8" Margin="0,5,0,10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Background>
                                <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0.5,1">
                                    <GradientStop Color="#FF3A3053" />
                                    <GradientStop Offset="1" Color="#FF40365B" />
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid Grid.Row="0">
                                <ToggleButton
                                    Width="Auto"
                                    Height="30"
                                    HorizontalAlignment="Left"
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Foreground="#BDAEE2"
                                    IsChecked="{Binding Settings_WindowActivity, Mode=TwoWay}"
                                    Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                    Tag="Window activity options"
                                    TextOptions.TextRenderingMode="ClearType" />
                            </Grid>


                            <Grid
                                Grid.Row="1"
                                Width="auto"
                                Margin="10,0,0,0"
                                Visibility="{Binding Settings_WindowActivity, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <CheckBox
                                    x:Name="enhancedapp_checkbox"
                                    Height="20"
                                    Margin="0,15,0,0"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ApplicationHookV2, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Enhanced application hook for Window activity integration
                                </CheckBox>
                                <Border
                                    Grid.Row="1"
                                    Margin="0,15,1,0"
                                    Background="DarkSlateBlue"
                                    CornerRadius="5">
                                    <Grid Margin="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150" />
                                            <ColumnDefinition Width="80" />
                                            <ColumnDefinition Width="125" />
                                            <ColumnDefinition Width="65" />
                                            <ColumnDefinition Width="188" />
                                        </Grid.ColumnDefinitions>

                                        <Button
                                            Grid.Column="0"
                                            Margin="3,0"
                                            Command="{Binding SortScannedAppsByProcessNameCommand}"
                                            Style="{StaticResource Sort_Button_style}">
                                            <TextBlock
                                                Padding="5"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Text="App" />
                                        </Button>
                                        <Button
                                            Grid.Column="1"
                                            Margin="3,0"
                                            Command="{Binding SortScannedAppsByFocusCountCommand}"
                                            Style="{StaticResource Sort_Button_style}">
                                            <TextBlock
                                                Padding="5"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Text="Focused" />
                                        </Button>
                                        <Button
                                            Grid.Column="2"
                                            Margin="3,0"
                                            Command="{Binding SortScannedAppsByUsedNewMethodCommand}"
                                            Style="{StaticResource Sort_Button_style}">
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Text="Enhanced hook" />
                                        </Button>
                                        <Button
                                            Grid.Column="3"
                                            Margin="3,0"
                                            Command="{Binding SortScannedAppsByIsPrivateAppCommand}"
                                            Style="{StaticResource Sort_Button_style}">
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Text="Private" />
                                        </Button>
                                        <Button
                                            Grid.Column="4"
                                            Margin="3,0"
                                            Command="{Binding SortScannedAppsByApplyCustomAppNameCommand}"
                                            Style="{StaticResource Sort_Button_style}">
                                            <TextBlock
                                                FontFamily="Albert Sans Thin"
                                                FontSize="14"
                                                Text="Custom app name" />
                                        </Button>
                                    </Grid>
                                </Border>

                                <ItemsControl Grid.Row="2" ItemsSource="{Binding ScannedApps, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate DataType="{x:Type vm:ProcessInfo}">
                                            <Border
                                                Margin="0,15,0,0"
                                                Background="DarkSlateBlue"
                                                CornerRadius="5">
                                                <Grid Margin="10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="150" />
                                                        <ColumnDefinition Width="80" />
                                                        <ColumnDefinition Width="125" />
                                                        <ColumnDefinition Width="65" />
                                                        <ColumnDefinition Width="188" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock
                                                        Grid.Column="0"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="16"
                                                        Foreground="#FFB9B5C1"
                                                        Text="{Binding ProcessName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        Grid.Column="1"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="16"
                                                        Foreground="#FFB9B5C1"
                                                        Text="{Binding FocusCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    <TextBlock
                                                        Grid.Column="2"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="16"
                                                        Foreground="#FFB9B5C1"
                                                        Text="{Binding UsedNewMethod, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                                    <CheckBox
                                                        x:Name="IsPrivateApp"
                                                        Grid.Column="3"
                                                        Width="23"
                                                        Height="20"
                                                        HorizontalAlignment="Center"
                                                        BorderBrush="#FF2D1265"
                                                        FontFamily="Comfortaa Light"
                                                        FontSize="18"
                                                        Foreground="#FFB9B5C1"
                                                        IsChecked="{Binding IsPrivateApp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        Style="{DynamicResource SettingsCheckbox}" />
                                                    <StackPanel
                                                        Grid.Column="4"
                                                        Width="186"
                                                        Orientation="Horizontal">
                                                        <CheckBox
                                                            x:Name="ApplyCustomAppName"
                                                            Width="23"
                                                            Height="20"
                                                            Margin="5,0,0,0"
                                                            BorderBrush="#FF2D1265"
                                                            FontFamily="Comfortaa Light"
                                                            FontSize="18"
                                                            Foreground="#FFB9B5C1"
                                                            IsChecked="{Binding ApplyCustomAppName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                            Style="{DynamicResource SettingsCheckbox}" />
                                                        <TextBox
                                                            Width="150"
                                                            Margin="5,0,0,0"
                                                            Padding="5,0,0,0"
                                                            VerticalAlignment="Center"
                                                            VerticalContentAlignment="Center"
                                                            Background="#FF7B7195"
                                                            BorderThickness="0"
                                                            FontSize="15"
                                                            Foreground="#FF240E54"
                                                            Text="{Binding CustomAppName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <TextBox.Style>
                                                                <Style TargetType="{x:Type TextBox}">
                                                                    <Setter Property="Opacity" Value="0.3" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding ApplyCustomAppName}" Value="True">
                                                                            <Setter Property="Opacity" Value="1" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBox.Style>
                                                        </TextBox>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </Grid>
                    </Grid>
                </ScrollViewer>
                <Grid
                    Grid.Row="1"
                    Background="#FF3B3054"
                    Visibility="{Binding MenuItem_2_Visibility}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="31" />
                        <RowDefinition Height="35" />
                        <RowDefinition Height="400" />
                        <RowDefinition Height="40" />
                        <RowDefinition Height="68" />
                    </Grid.RowDefinitions>

                    <Grid
                        Grid.Row="4"
                        Width="658"
                        Height="68"
                        HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="550" />
                            <ColumnDefinition Width="150" />
                        </Grid.ColumnDefinitions>
                        <Button
                            x:Name="ButtonChattingTxt"
                            Grid.ColumnSpan="2"
                            Width="94"
                            Margin="542,14,0,14"
                            HorizontalAlignment="Left"
                            Click="ButtonChattingTxt_Click"
                            Content="Send"
                            Style="{DynamicResource Status_Button_style}" />
                        <TextBox
                            x:Name="NewChattingTxt"
                            Height="40"
                            Margin="15,0,0,0"
                            Padding="8,0,55,0"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Background="#FF7B7195"
                            BorderThickness="0"
                            FontSize="15"
                            Foreground="#FF240E54"
                            KeyDown="NewChattingTxt_KeyDown"
                            Text="{Binding NewChattingTxt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            TextAlignment="Left"
                            TextChanged="NewChattingTxt_TextChanged"
                            TextWrapping="Wrap">
                            <TextBox.Resources>
                                <Style TargetType="{x:Type Border}">
                                    <Setter Property="CornerRadius" Value="5" />
                                </Style>
                            </TextBox.Resources>
                            <TextBox.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Quality"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </TextBox.Effect>
                        </TextBox>

                        <TextBlock
                            Grid.Column="0"
                            Margin="0,0,7,0"
                            Padding="0,3,0,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="12"
                            Foreground="{Binding ChatBoxColor}"
                            Text="{Binding ChatBoxCount}" />

                        <TextBlock
                            Height="40"
                            Margin="15,0,55,0"
                            Padding="8,9,5,0"
                            VerticalAlignment="Center"
                            FontSize="15"
                            Foreground="#FF3D2F5F"
                            IsHitTestVisible="False"
                            Text="Send a chat message"
                            TextAlignment="Left">
                            <TextBlock.Style>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Text, ElementName=NewChattingTxt}" Value="">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName=NewChattingTxt, Path=IsFocused}" Value="True">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>

                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                    <Grid Grid.Row="1" Background="#FF493F65">
                        <Grid.Effect>
                            <DropShadowEffect
                                BlurRadius="10"
                                Direction="-90"
                                Opacity="0.5"
                                RenderingBias="Quality"
                                ShadowDepth="5"
                                Color="#FF7F759A" />
                        </Grid.Effect>
                        <StackPanel
                            HorizontalAlignment="Stretch"
                            Orientation="Horizontal"
                            Visibility="{Binding CountDownUI, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <TextBlock
                                Grid.Column="0"
                                Margin="16,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text="Visible for " />
                            <TextBlock
                                Grid.Column="0"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text="{Binding ScanPauseCountDown, UpdateSourceTrigger=PropertyChanged}" />
                            <TextBlock
                                Grid.Column="0"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text=" seconds"
                                Visibility="{Binding CountDownUI, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />

                        </StackPanel>
                        <TextBlock
                            Grid.Column="0"
                            Margin="0,3,153,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="13"
                            Foreground="#FF6FD013"
                            Text="{Binding ActiveChatTxt, UpdateSourceTrigger=PropertyChanged}" />
                        <Button
                            x:Name="ClearChat"
                            Width="80"
                            Margin="0,5,20,5"
                            HorizontalAlignment="Right"
                            Click="ClearChat_Click"
                            Content="Clear history"
                            Style="{DynamicResource Status_Button_style}" />
                        <Button
                            x:Name="StopChat"
                            Width="40"
                            Margin="0,5,105,5"
                            HorizontalAlignment="Right"
                            Click="StopChat_Click"
                            Content="Stop"
                            Style="{DynamicResource Status_Button_style}" />
                    </Grid>

                    <Grid Grid.Row="2">
                        <ScrollViewer
                            Name="RecentScroll"
                            Margin="7,10,0,0"
                            Visibility="Visible">
                            <ItemsControl
                                HorizontalAlignment="Left"
                                VerticalAlignment="Bottom"
                                ItemsSource="{Binding LastMessages, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Vertical" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Width="620"
                                            Height="auto"
                                            Margin="8,0,0,8"
                                            Background="DarkSlateBlue"
                                            BorderThickness="0"
                                            CornerRadius="5"
                                            Opacity="{Binding Opacity}">
                                            <StackPanel
                                                Height="auto"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBox
                                                    Width="475"
                                                    Height="Auto"
                                                    Padding="15,15,0,15"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="16"
                                                    Foreground="LightGray"
                                                    IsReadOnly="True"
                                                    Text="{Binding Msg}"
                                                    TextWrapping="Wrap" />
                                                <Button
                                                    Width="80"
                                                    Margin="5,5,0,5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding SendAgainCommand}"
                                                    CommandParameter="{Binding Msg}"
                                                    Content="Send again"
                                                    Style="{DynamicResource Status_Button_style}" />
                                                <Button
                                                    Width="50"
                                                    Margin="5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding CopyToClipboardCommand}"
                                                    CommandParameter="{Binding Msg}"
                                                    Content="Copy"
                                                    Style="{DynamicResource Status_Button_style}" />
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                    <Grid
                        Grid.Row="3"
                        HorizontalAlignment="Stretch"
                        Background="#FF493F65">
                        <Grid.Effect>
                            <DropShadowEffect
                                BlurRadius="10"
                                Direction="90"
                                Opacity="0.5"
                                RenderingBias="Quality"
                                ShadowDepth="5"
                                Color="#FF7F759A" />
                        </Grid.Effect>
                        <StackPanel Orientation="Horizontal">
                            <Button
                                x:Name="IntgrIntelliWing_btn"
                                Width="39"
                                Margin="16,3,0,3"
                                Padding="3"
                                HorizontalAlignment="Left"
                                Click="IntgrIntelliWing_btn_Click"
                                Style="{DynamicResource OpenAI_Button_style}"
                                Visibility="{Binding IntgrIntelliChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                            <TextBlock
                                Grid.Column="0"
                                Margin="10,0,0,0"
                                Padding="0,0,50,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="16"
                                Foreground="#FF9983AD"
                                Text="{Binding ChatTopBarTxt}" />
                        </StackPanel>
                        <TextBlock
                            Grid.Column="0"
                            Margin="0,0,16,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Foreground="#FF9983AD"
                            Text="{Binding ChatFeedbackTxt}" />

                    </Grid>
                </Grid>

                <Grid
                    Grid.Row="1"
                    Grid.Column="1"
                    Background="#FF42385D">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontFamily="Albert Sans Thin"
                        FontSize="16"
                        Foreground="White"
                        Text="Preview" />
                    <TextBlock
                        Grid.Column="0"
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        FontFamily="Albert Sans Thin"
                        FontSize="12"
                        Foreground="#FF8D7DB9"
                        Text="{Binding OSCmsg_countUI}" />

                    <TextBox
                        Grid.Row="1"
                        Height="150"
                        Margin="5,0,5,0"
                        Padding="8,5,8,5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Top"
                        AllowDrop="False"
                        Background="#FF7F759A"
                        BorderThickness="0"
                        Focusable="False"
                        FontFamily="Albert Sans Thin"
                        FontSize="13"
                        Foreground="#FFDFDDE2"
                        IsHitTestVisible="False"
                        IsReadOnly="True"
                        IsTabStop="False"
                        MaxLength="144"
                        Text="{Binding OSCtoSent}"
                        TextAlignment="Center"
                        TextWrapping="Wrap" />


                    <StackPanel
                        Grid.Row="1"
                        Margin="0,155,0,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top">

                        <StackPanel
                            Width="auto"
                            Height="auto"
                            Margin="5,5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Orientation="Horizontal">
                            <Button
                                x:Name="ToggleVoicebtn"
                                Width="101"
                                Height="27"
                                local:ButtonProperties.ShadowTrigger="{Binding TTSBtnShadow}"
                                Click="ToggleVoicebtn_Click"
                                Content="{Binding ToggleVoiceText}"
                                Style="{DynamicResource Status_Button_style_Shadow}" />
                        </StackPanel>


                        <StackPanel
                            Width="80"
                            Height="20"
                            Margin="0,5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,5,0"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#FF7D7397"
                                Text="TopMost" />
                            <CheckBox
                                Width="20"
                                BorderBrush="#FF2D1265"
                                FontFamily="Comfortaa Light"
                                FontSize="12"
                                Foreground="#FFB9B5C1"
                                IsChecked="{Binding Topmost, Mode=TwoWay}"
                                Style="{DynamicResource SettingsCheckbox}" />
                        </StackPanel>

                        <StackPanel
                            Width="112"
                            Height="20"
                            Margin="0,5"
                            HorizontalAlignment="Right"
                            Orientation="Horizontal"
                            Visibility="{Binding MenuItem_2_Visibility}">
                            <TextBlock
                                Margin="0,0,5,0"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#FF7D7397"
                                Text="Text to speech" />
                            <CheckBox
                                Width="20"
                                BorderBrush="#FF2D1265"
                                FontFamily="Comfortaa Light"
                                FontSize="12"
                                Foreground="#FFB9B5C1"
                                IsChecked="{Binding TTSTikTokEnabled, Mode=TwoWay}"
                                Style="{DynamicResource SettingsCheckbox}" />
                        </StackPanel>

                        <StackPanel Visibility="{Binding TTSTikTokEnabled, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel
                                Width="176"
                                Height="22"
                                Margin="0,5"
                                HorizontalAlignment="Right"
                                Orientation="Horizontal"
                                Visibility="{Binding MenuItem_2_Visibility}">
                                <TextBlock
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF7D7397"
                                    Text="Voice" />
                                <ComboBox
                                    x:Name="TikTokTTSVoices_combo"
                                    Width="135"
                                    Height="21"
                                    BorderBrush="#FF020000"
                                    DisplayMemberPath="DisplayName"
                                    FontSize="11.5"
                                    ItemsSource="{Binding TikTokTTSVoices, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Opacity="0.4"
                                    SelectedValuePath="ApiName"
                                    SelectionChanged="TikTokTTSVoices_combo_SelectionChanged" />
                            </StackPanel>

                            <StackPanel
                                Width="211"
                                Height="22"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Right"
                                Orientation="Horizontal"
                                Visibility="{Binding MenuItem_2_Visibility}">
                                <TextBlock
                                    Width="69"
                                    Margin="0,0,0,3"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF7D7397"
                                    Text="TTS volume" />
                                <Slider
                                    x:Name="VolumeSlider"
                                    Width="134.5"
                                    Height="12"
                                    Margin="2.2,0,4.5,0"
                                    Maximum="1"
                                    Minimum="0"
                                    Style="{StaticResource CustomSlider}"
                                    Value="{Binding Path=TTSVolume, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </StackPanel>
                        </StackPanel>

                    </StackPanel>
                    <Grid
                        Grid.Row="3"
                        Height="45"
                        VerticalAlignment="Bottom">
                        <TextBlock
                            HorizontalAlignment="Center"
                            VerticalAlignment="Stretch"
                            FontFamily="Albert Sans Thin"
                            FontSize="12"
                            Foreground="#FF7D7397"
                            Text="{Binding UpdateStatustxt}" />
                        <TextBlock
                            x:Name="GitHubChanges"
                            Width="auto"
                            HorizontalAlignment="Center"
                            Cursor="Hand"
                            FontFamily="Albert Sans Thin"
                            FontSize="10"
                            Foreground="#FF31B7B4"
                            MouseUp="GitHubChanges_MouseUp"
                            Text="View changes on GitHub"
                            TextDecorations="Underline"
                            Visibility="{Binding CanUpdate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            Orientation="Horizontal">

                            <TextBlock
                                Margin="5,0.5,5,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Stretch"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF7D7397"
                                Text="{Binding AppVersion.VersionNumber}" />
                            <TextBlock
                                Name="NewVersion"
                                Margin="0,0,5,8"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Bottom"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="{Binding VersionTxtColor}"
                                MouseUp="NewVersion_MouseUp"
                                Text="{Binding VersionTxt}"
                                TextDecorations="Underline" />
                        </StackPanel>
                    </Grid>

                </Grid>
            </Grid>
        </Border>

    </Grid>
</Window>




